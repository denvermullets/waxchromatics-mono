<%= turbo_frame_tag "discography_#{release_type}" do %>
  <div data-controller="collapsible" class="mb-6">
    <button
      type="button"
      data-action="collapsible#toggle"
      class="
        w-full flex items-center justify-between py-3 text-left
        cursor-pointer transition-colors
      "
    >
      <h3 class="text-sm font-semibold uppercase tracking-wider text-woodsmoke-300">
        <%= release_type.pluralize %>

        <span class="ml-2 text-xs font-normal text-woodsmoke-500">
          (<%= pagy.count %>)
        </span>
      </h3>

      <div class="flex items-center gap-3">
        <%= link_to "View All",
                    discography_type_artist_path(artist, release_type: release_type),
                    data: { turbo_frame: "_top" },
                    class: "text-xs font-medium text-woodsmoke-500 hover:text-crusta-400 transition-colors" %>

        <svg
          data-collapsible-target="icon"
          class="w-4 h-4 text-woodsmoke-400 transition-transform"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 9l-7 7-7-7"
          />
        </svg>
      </div>
    </button>

    <div data-collapsible-target="content">
      <div class="space-y-3">
        <% release_groups.each do |release_group| %>
          <%= render 'artists/release_group_card', release_group: release_group, artist: artist %>
        <% end %>
      </div>

      <div class="mt-4 flex items-center justify-between">
        <%= link_to "View All",
                    discography_type_artist_path(artist, release_type: release_type),
                    data: { turbo_frame: "_top" },
                    class: "text-sm font-medium text-woodsmoke-400 hover:text-crusta-400 transition-colors" %>

        <% if pagy.last > 1 %>
          <div class="flex items-center gap-3">
            <span class="text-xs text-woodsmoke-500">
              <%= pagy.page %> / <%= pagy.last %>
            </span>

            <div class="flex gap-1">
              <% if pagy.previous %>
                <%= link_to discography_section_artist_path(artist, release_type: release_type, page: pagy.previous),
                            data: { turbo_frame: "discography_#{release_type}" },
                            class: "px-3 py-1.5 text-sm font-medium rounded-sm border border-woodsmoke-700 text-woodsmoke-200 hover:border-woodsmoke-500 transition-colors" do %>
                  &larr;
                <% end %>
              <% end %>

              <% if pagy.next %>
                <%= link_to discography_section_artist_path(artist, release_type: release_type, page: pagy.next),
                            data: { turbo_frame: "discography_#{release_type}" },
                            class: "px-3 py-1.5 text-sm font-medium rounded-sm border border-woodsmoke-700 text-woodsmoke-200 hover:border-woodsmoke-500 transition-colors" do %>
                  &rarr;
                <% end %>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
<% end %>
