<div class="max-w-7xl mx-auto px-4 py-8">
  <% if notice = flash[:notice] %>
    <p class="py-2 px-3 bg-bright-turquoise-950 mb-5 text-bright-turquoise-300 font-medium rounded-lg inline-block" id="notice"><%= notice %></p>
  <% end %>

  <%# Breadcrumb %>
  <div class="mb-6 flex items-center gap-2 text-sm text-woodsmoke-400">
    <%= link_to "Home", root_path, class: "hover:text-crusta-400 transition-colors" %>
    <span>/</span>
    <% if @artists.any? %>
      <%= link_to @artist.name, artist_path(@artist), class: "hover:text-crusta-400 transition-colors" %>
      <span>/</span>
    <% end %>
    <% if @release_group %>
      <%= link_to @release_group.title, artist_release_group_path(@artist, @release_group), class: "hover:text-crusta-400 transition-colors" %>
      <span>/</span>
    <% end %>
    <span class="text-woodsmoke-300"><%= @labels.first&.catalog_number.presence || @release.title %></span>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <%# Left column: cover, notes, actions %>
    <div class="lg:col-span-1 space-y-4">
      <% if @release.cover_art_url.present? %>
        <div class="w-full aspect-square rounded-xl border border-woodsmoke-700 overflow-hidden bg-woodsmoke-700">
          <%= image_tag @release.cover_art_url, alt: @release.title, class: "w-full h-full object-cover" %>
        </div>
      <% else %>
        <%= render "shared/cover_art", size: :xl, vinyl_svg: @formats.first&.vinyl_image_path %>
      <% end %>

      <% if @release.notes.present? %>
        <div class="p-4 rounded-xl border border-woodsmoke-800 bg-woodsmoke-900">
          <h3 class="text-xs font-semibold uppercase tracking-wider text-woodsmoke-400 mb-2">Notes</h3>
          <p class="text-sm text-woodsmoke-300 leading-relaxed whitespace-pre-line"><%= @release.notes %></p>
        </div>
      <% end %>

      <div class="flex gap-3">
        <button class="flex-1 px-4 py-2.5 rounded-lg bg-crusta-400 hover:bg-crusta-500 text-woodsmoke-950 font-semibold text-sm transition-colors cursor-pointer">
          Add to Wantlist
        </button>
        <button class="flex-1 px-4 py-2.5 rounded-lg border border-woodsmoke-700 text-woodsmoke-200 hover:border-woodsmoke-500 font-semibold text-sm transition-colors cursor-pointer">
          Add to Collection
        </button>
      </div>

      <% contributors = @artists.reject { |a| a.id == @artist.id } %>
      <% if contributors.any? %>
        <div class="p-4 rounded-xl border border-woodsmoke-800 bg-woodsmoke-900">
          <h3 class="text-xs font-semibold uppercase tracking-wider text-woodsmoke-400 mb-3">Credits</h3>
          <div class="flex flex-wrap gap-1 text-sm">
            <% contributors.each_with_index do |artist, i| %>
              <% if i > 0 %><span class="text-woodsmoke-500">,</span><% end %>
              <%= link_to artist.name, artist_path(artist), class: "text-crusta-400 hover:text-crusta-300 transition-colors" %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <%# Right column: badges, title, info, tracklist %>
    <div class="lg:col-span-2 space-y-6">
      <%= render "releases/header" %>
      <%= render "releases/info_table" %>
      <%= render "releases/matrix_runout" %>
      <%= render "releases/tracklist" %>
    </div>
  </div>
</div>
